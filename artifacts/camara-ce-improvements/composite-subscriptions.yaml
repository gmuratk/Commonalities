openapi: 3.0.3
info:
  title: CAMARA Extended CloudEvents
  version: 1.0.0
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
servers:
  - url: '{apiRoot}'
    variables:
      apiRoot:
        default: http://localhost:9091
        description: API root, defined by the service provider, e.g. api.example.com or api.example.com/somepath
paths:
  /subscriptions:
    post:
      tags:
        - CAMARA Extended CloudEvents Subscription
      summary: Create a CAMARA CloudEvents subscription for receiving callbacks
      description: |
        Create a CAMARA CloudEvents subscription for receiving callbacks.
        Implementations SHOULD perform CloudEvents HTTP WebHook validation before first delivery and MAY return 202 Accepted with status=ACTIVATION_REQUESTED until validation completes.
      operationId: createCamaraCloudEventsSubscription
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      security:
        - openId:
            - camara-cloudevents-subscriptions:org.camaraproject.camara-cloudevents-subscriptions.v0.common:create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CamaraExtendedSubscriptionRequest'
      callbacks:
        notifications:
          '{$request.body#/sink}':
            post:
              summary: CAMARA CloudEvents notifications callback
              description: |
                Important: this endpoint is to be implemented by the API consumer.
                The CAMARA Cloud Events server will call this endpoint whenever the common CAMARA CloudEvents.
              operationId: postCamaraCloudEventsNotification
              parameters:
                - $ref: '#/components/parameters/x-correlator'
              requestBody:
                required: true
                content:
                  application/cloudevents-batch+json:
                    schema:
                      type: array
                      items:
                        $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
              responses:
                '204':
                  description: Successful notification
                  headers:
                    x-correlator:
                      $ref: '#/components/headers/x-correlator'
                '400':
                  $ref: '#/components/responses/Generic400'
                '401':
                  $ref: '#/components/responses/Generic401'
                '403':
                  $ref: '#/components/responses/Generic403'
                '410':
                  $ref: '#/components/responses/Generic410'
                '429':
                  $ref: '#/components/responses/Generic429'
              security:
                - notificationsBearerAuth: []
        webhookValidation:
          '{$request.body#/sink}':
            options:
              summary: CAMARA CloudEvents HTTP WebHook validation callback
              operationId: optionsCamaraCloudEventsWebhookValidation
              parameters:
                - $ref: '#/components/parameters/x-correlator'
                - in: header
                  name: WebHook-Request-Origin
                  required: true
                  schema:
                    type: string
                  description: Origin of the WebHook sender per CloudEvents HTTP WebHook 1.0.x.
              responses:
                '200':
                  description: Sink allows delivery from this origin.
                  headers:
                    x-correlator:
                      $ref: '#/components/headers/x-correlator'
                    WebHook-Allowed-Origin:
                      schema:
                        type: string
                      description: Echo of the approved origin.
                '403':
                  $ref: '#/components/responses/Generic403'
        subscriptionLifecycle:
          '{$request.body#/sink}':
            post:
              summary: CAMARA CloudEvents subscription lifecycle callback
              description: |
                One CloudEvents 'type' with three payload formats, distinguished by 'datacontenttype': - application/json-patch+json: data is a JSON Patch (RFC 6902) array - application/merge-patch+json: data is a JSON Merge Patch (RFC 7396) document - application/json: data is a full {previous,current} snapshot
              operationId: postCamaraCloudEventsSubscriptionLifecycleNotification
              parameters:
                - $ref: '#/components/parameters/x-correlator'
              requestBody:
                required: true
                content:
                  application/cloudevents+json:
                    schema:
                      oneOf:
                        - $ref: '#/components/schemas/CamaraConfigChangeEventJsonPatch'
                        - $ref: '#/components/schemas/CamaraConfigChangeEventMergePatch'
                        - $ref: '#/components/schemas/CamaraConfigChangeEventSnapshot'
                      discriminator:
                        propertyName: datacontenttype
                        mapping:
                          application/json-patch+json: '#/components/schemas/CamaraConfigChangeEventJsonPatch'
                          application/merge-patch+json: '#/components/schemas/CamaraConfigChangeEventMergePatch'
                          application/json: '#/components/schemas/CamaraConfigChangeEventSnapshot'
              responses:
                '204':
                  description: Successful lifecycle notification
                  headers:
                    x-correlator:
                      $ref: '#/components/headers/x-correlator'
                '400':
                  $ref: '#/components/responses/Generic400'
                '401':
                  $ref: '#/components/responses/Generic401'
                '403':
                  $ref: '#/components/responses/Generic403'
                '410':
                  $ref: '#/components/responses/Generic410'
                '429':
                  $ref: '#/components/responses/Generic429'
              security:
                - notificationsBearerAuth: []
      responses:
        '201':
          description: Created (Successful creation of subscription) and validation not required or already satisfied.
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
            ETag:
              $ref: '#/components/headers/ETag'
            Accept-Patch:
              $ref: '#/components/headers/Accept-Patch'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CamaraExtendedSubscription'
        '202':
          description: Request accepted to be processed. It applies for async creation process. When subscription created, validation handshake is pending per CloudEvents HTTP WebHook.
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionAsync'
        '400':
          $ref: '#/components/responses/CreateSubscriptionBadRequest400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/SubscriptionPermissionDenied403'
        '409':
          $ref: '#/components/responses/Generic409'
        '422':
          $ref: '#/components/responses/CreateSubscriptionUnprocessableEntity422'
        '429':
          $ref: '#/components/responses/Generic429'
    get:
      tags:
        - CAMARA Extended CloudEvents Subscription
      summary: Retrieve CAMARA CloudEvents subscriptions
      description: Retrieve a list of CAMARA CloudEvents subscription(s)
      operationId: retrieveCamaraCloudEventsSubscriptionList
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      security:
        - openId:
            - camara-cloudevents-subscriptions:read
      responses:
        '200':
          description: List of event subscription details
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                type: array
                minItems: 0
                items:
                  $ref: '#/components/schemas/CamaraExtendedSubscription'
        '400':
          $ref: '#/components/responses/Generic400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
    options:
      tags:
        - CAMARA Extended CloudEvents Subscription
      summary: Discover CAMARA CloudEvents subscriptions features
      description: Discover supported features and methods for this endpoint
      operationId: getCamaraCloudEventsFeatures
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      security:
        - openId:
            - camara-cloudevents-subscriptions:read
      responses:
        '200':
          description: OK
          headers:
            Allow:
              schema:
                type: string
                default: GET,POST,OPTIONS
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/Generic400'
  /subscriptions/{id}:
    get:
      tags:
        - CAMARA Extended CloudEvents Subscription
      summary: Retrieve a CAMARA CloudEvents subscription
      description: retrieve CAMARA CloudEvents subscription.
      operationId: retrieveCamaraCloudEventsSubscription
      security:
        - openId:
            - camara-cloudevents-subscriptions:read
      parameters:
        - $ref: '#/components/parameters/x-correlator'
        - $ref: '#/components/parameters/SubscriptionId'
        - $ref: '#/components/parameters/If-None-Match'
        - $ref: '#/components/parameters/If-Modified-Since'
      responses:
        '200':
          description: |
            Subscription metadata.
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Last-Modified:
              $ref: '#/components/headers/Last-Modified'
            Accept-Patch:
              $ref: '#/components/headers/Accept-Patch'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CamaraExtendedSubscription'
        '304':
          $ref: '#/components/responses/Generic304'
        '400':
          $ref: '#/components/responses/SubscriptionIdRequired400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/Generic404'
        '409':
          $ref: '#/components/responses/Generic409'
    put:
      tags:
        - CAMARA Extended CloudEvents Subscription
      operationId: updateCamaraCloudEventsSubscription
      summary: Update CAMARA CloudEvents subscription
      description: |
        Update a CAMARA CloudEvents subscription (full update). The request body MUST contain a full Subscription representation. Enforce 422 for forbidden transitions; 412 for ETag mismatches; 409 for already-final states. If status: "EXPIRED" is, then sends 422.
      security:
        - openId:
            - camara-cloudevents-subscriptions:put
      parameters:
        - $ref: '#/components/parameters/SubscriptionId'
        - $ref: '#/components/parameters/x-correlator'
        - $ref: '#/components/parameters/If-Match'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CamaraExtendedSubscriptionMergePatch'
      responses:
        '200':
          description: OK
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CamaraExtendedSubscription'
        '204':
          description: Updated, no content
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/CreateSubscriptionBadRequest400'
        '404':
          $ref: '#/components/responses/Generic404'
        '409':
          $ref: '#/components/responses/Generic409'
        '412':
          $ref: '#/components/responses/Generic412'
        '422':
          $ref: '#/components/responses/CreateSubscriptionUnprocessableEntity422'
    patch:
      tags:
        - CAMARA Extended CloudEvents Subscription
      operationId: patchCamaraCloudEventsSubscription
      summary: Partially modify CAMARA CloudEvents subscription
      description: |
        Apply partial modifications using JSON Merge Patch (RFC 7396) using application/merge-patch+json or JSON Patch (RFC 6902) using application/json-patch+json. The PATCH shape follows the HTTP/PATCH spec (RFC 5789), supports both Merge Patch (RFC 7396) and JSON Patch (RFC 6902), and advertises formats via the Accept-Patch response header. Enforce 422 for forbidden transitions; 412 for ETag mismatches; 409 for already-final states. If status: "EXPIRED" is, then sends 422.
      security:
        - openId:
            - camara-cloudevents-subscriptions:patch
      parameters:
        - $ref: '#/components/parameters/SubscriptionId'
        - $ref: '#/components/parameters/x-correlator'
        - $ref: '#/components/parameters/If-Match'
      requestBody:
        required: true
        content:
          application/merge-patch+json:
            schema:
              $ref: '#/components/schemas/CamaraExtendedSubscriptionMergePatch'
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/CamaraExtendedJsonPatchOperation'
            examples:
              pauseSubscription:
                value:
                  - op: replace
                    path: /status
                    value: INACTIVE
      responses:
        '200':
          description: OK
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CamaraExtendedSubscription'
        '204':
          description: Updated, no content
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/CreateSubscriptionBadRequest400'
        '404':
          $ref: '#/components/responses/Generic404'
        '409':
          $ref: '#/components/responses/Generic409'
        '412':
          $ref: '#/components/responses/Generic412'
        '415':
          $ref: '#/components/responses/Generic415'
        '422':
          $ref: '#/components/responses/CreateSubscriptionUnprocessableEntity422'
    delete:
      tags:
        - CAMARA Extended CloudEvents Subscription
      summary: Delete CAMARA CloudEvents subscription
      operationId: deleteCamaraCloudEventsSubscription
      description: delete a given CAMARA CloudEvents subscription.
      security:
        - openId:
            - camara-cloudevents-subscriptions:delete
      parameters:
        - $ref: '#/components/parameters/SubscriptionId'
        - $ref: '#/components/parameters/x-correlator'
      responses:
        '202':
          description: Request accepted to be processed. It applies for async deletion process.
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionAsync'
        '204':
          description: CAMARA CloudEvents subscription deleted
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/SubscriptionIdRequired400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/Generic404'
    options:
      tags:
        - CAMARA Extended CloudEvents Subscription
      operationId: getCamaraCloudEventsSubscriptionFeatures
      summary: Discover CAMARA CloudEvents subscription features
      description: Discover supported features and methods for this endpoint
      security:
        - openId:
            - camara-cloudevents-subscriptions:read
      parameters:
        - $ref: '#/components/parameters/SubscriptionId'
        - $ref: '#/components/parameters/x-correlator'
      responses:
        '200':
          description: OK
          headers:
            Allow:
              schema:
                type: string
                default: GET,PUT,PATCH,DELETE,OPTIONS
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/Generic400'
  /camara/cloudevents/webhook/v0:
    post:
      tags:
        - CAMARA Cloud Events
      summary: Cloud Event notification endpoint to notify consumer that statement of fact had occurred
      description: |
        INFORMATIVE ENDPOINT: The value of this endpoint is freely declared by each client app by means of resource-based
        subscription or instance-based subscription. /camara/cloudevents/webhook/v0 is
        just a convention naming referring to an absolute URL, indeed the one indicated by API client
        in the triggering of the procedure (resource-based or instance-based).  In this way, it represents an absolute
        URL, i.e.: notifications won't be sent to /event-notification/vX/your_webhook_notification_url.
      operationId: sendCamaraCloudEvents
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      requestBody:
        required: true
        content:
          application/cloudevents-batch+json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
      responses:
        '204':
          description: No Content
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/Generic400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '410':
          $ref: '#/components/responses/Generic410'
        '429':
          $ref: '#/components/responses/Generic429'
  /sessions:
    post:
      tags:
        - QoS Sessions
      summary: Creates a new session
      description: |
        Create QoS Session to manage latency/throughput priorities

        If the qosStatus in the API response is "AVAILABLE" and a notification callback is provided the API consumer will receive in addition to the response a
        `QOS_STATUS_CHANGED` event notification with `qosStatus` as `AVAILABLE`.

        If the `qosStatus` in the API response is `REQUESTED`, the client will receive either
        - a `QOS_STATUS_CHANGED` event notification with `qosStatus` as `AVAILABLE` after the network notifies that it has created the requested session, or
        - a `QOS_STATUS_CHANGED` event notification with `qosStatus` as `UNAVAILABLE` and `statusInfo` as `NETWORK_TERMINATED` after the network notifies that it has failed to provide the requested session.

        A `QOS_STATUS_CHANGED` event notification with `qosStatus` as `UNAVAILABLE` will also be send if the network terminates the session before the requested duration expired

        **NOTES:**
        - In case of a `QOS_STATUS_CHANGED` event with `qosStatus` as `UNAVAILABLE` and `statusInfo` as `NETWORK_TERMINATED` the resources of the QoS session are not directly released, but will get deleted automatically at earliest 360 seconds after the event.

          This behavior allows API consumers which are not receiving notification events but are polling to get the session information with the `qosStatus` `UNAVAILABLE` and `statusInfo` `NETWORK_TERMINATED`. Before a API consumer can attempt to create a new QoD session for the same device and flow period they must release the session resources with an explicit `delete` operation if not yet automatically deleted.
        - The access token may be either 2-legged or 3-legged. See "Identifying the device from the access token" for further information
          - When the API is invoked using a two-legged access token, the subject will be identified from the optional `device` object, which therefore MUST be provided.
          - When a three-legged access token is used however, this optional identifier MUST NOT be provided, as the subject will be uniquely identified from the access token.
      operationId: createSession
      security:
        - openId:
            - quality-on-demand:sessions:create
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      requestBody:
        description: Parameters to create a new session
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSession'
        required: true
      callbacks:
        notifications:
          '{$request.body#/subscriptionRequest/sink}':
            post:
              tags:
                - Session notifications callback
              summary: Session notifications callback
              description: |
                Important: this endpoint is to be implemented by the API consumer.
                The API provider will call this endpoint whenever any QoS session change (e.g. network termination) related event occurs.
                Currently only QOS_STATUS_CHANGED event is defined.
              operationId: postNotification
              parameters:
                - $ref: '#/components/parameters/x-correlator'
              requestBody:
                required: true
                content:
                  application/cloudevents+json:
                    schema:
                      $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
                    examples:
                      EVENT_QOS_STATUS_CHANGED_EXAMPLE:
                        $ref: '#/components/examples/EVENT_QOS_STATUS_CHANGED_EXAMPLE'
              responses:
                '204':
                  description: Successful notification
                  headers:
                    x-correlator:
                      $ref: '#/components/headers/x-correlator'
                '400':
                  $ref: '#/components/responses/Generic400'
                '401':
                  $ref: '#/components/responses/Generic401'
                '403':
                  $ref: '#/components/responses/Generic403'
                '410':
                  $ref: '#/components/responses/Generic410'
              security:
                - {}
                - notificationsBearerAuth: []
      responses:
        '201':
          description: Session created
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionInfo'
        '400':
          $ref: '#/components/responses/CreateSessionBadRequest400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/GenericDevice404'
        '409':
          $ref: '#/components/responses/SessionInConflict409'
        '422':
          $ref: '#/components/responses/Generic422'
        '429':
          $ref: '#/components/responses/Generic429'
  /sessions/{sessionId}:
    get:
      tags:
        - QoS Sessions
      summary: Get QoS session information
      description: |
        Querying for QoS session resource information details

        **NOTES:**
        - The access token may be either 2-legged or 3-legged.
        - If a 3-legged access token is used, the end user (and device) associated with the session must also be associated with the access token.
        - The session must have been created by the same API client given in the access token
      operationId: getSession
      security:
        - openId:
            - quality-on-demand:sessions:read
      parameters:
        - name: sessionId
          in: path
          description: Session ID that was obtained from the createSession operation
          required: true
          schema:
            $ref: '#/components/schemas/SessionId'
        - $ref: '#/components/parameters/x-correlator'
      responses:
        '200':
          description: Contains information about active session
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionInfo'
              examples:
                SESSION_AVAILABLE:
                  $ref: '#/components/examples/SESSION_AVAILABLE_EXAMPLE'
                SESSION_UNAVAILABLE:
                  $ref: '#/components/examples/SESSION_UNAVAILABLE_EXAMPLE'
        '400':
          $ref: '#/components/responses/Generic400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/Generic404'
        '429':
          $ref: '#/components/responses/Generic429'
    delete:
      tags:
        - QoS Sessions
      summary: Delete a QoS session
      description: |
        Release resources related to QoS session

        If the notification callback is provided and the `qosStatus` of the session was `AVAILABLE` the client will receive in addition to the response a `QOS_STATUS_CHANGED` event with
        - `qosStatus` as `UNAVAILABLE` and
        - `statusInfo` as `DELETE_REQUESTED`
        There will be no notification event if the `qosStatus` was already `UNAVAILABLE`.

        **NOTES:**
        - The access token may be either 2-legged or 3-legged.
        - If a 3-legged access token is used, the subject associated with the session must also be associated with the access token.
        - The session must must have been created by the same API consumer given in the access token
      operationId: deleteSession
      security:
        - openId:
            - quality-on-demand:sessions:delete
      parameters:
        - name: sessionId
          in: path
          description: Session ID that was obtained from the createSession operation
          required: true
          schema:
            $ref: '#/components/schemas/SessionId'
        - $ref: '#/components/parameters/x-correlator'
      responses:
        '204':
          description: Session deleted
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
        '400':
          $ref: '#/components/responses/Generic400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/Generic404'
        '429':
          $ref: '#/components/responses/Generic429'
  /sessions/{sessionId}/extend:
    post:
      tags:
        - QoS Sessions
      summary: Extend the duration of an active session
      description: |
        Extend the overall session duration of an active QoS session (with qosStatus = AVAILABLE).
        The overall duration of the QoS session, including the additional extended duration, shall not exceed the maximum duration limit fixed for the QoS Profile. If the current duration plus the value of `requestedAdditionalDuration` exceeds the maximum limit, the new overall duration shall be capped to the maximum value allowed.
        An example: For a QoS profile limited to a `maxDuration` of 50,000 seconds, a QoD session was originally created with duration 30,000 seconds. Before the session expires, the developer requests to extend the session by another 30,000 seconds:
        - Previous duration: 30,000 seconds
        - Requested additional duration: 30,000 seconds
        - New overall session duration: 50,000 seconds (the maximum allowed)

        **NOTES:**
        - The access token may be either 2-legged or 3-legged.
        - If a 3-legged access token is used, the subject associated with the session must also be associated with the access token.
        - The session must must have been created by the same API consumer given in the access token
      operationId: extendQosSessionDuration
      security:
        - openId:
            - quality-on-demand:sessions:update
      parameters:
        - name: sessionId
          in: path
          description: Session ID that was obtained from the createSession operation
          required: true
          schema:
            $ref: '#/components/schemas/SessionId'
        - $ref: '#/components/parameters/x-correlator'
      requestBody:
        description: Parameters to extend the duration of an active session
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExtendSessionDuration'
        required: true
      responses:
        '200':
          description: Contains information about active session
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionInfo'
        '400':
          $ref: '#/components/responses/GenericExtendSessionDuration400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/Generic404'
        '409':
          $ref: '#/components/responses/SessionStatusConflict409'
        '429':
          $ref: '#/components/responses/Generic429'
  /retrieve-sessions:
    post:
      tags:
        - QoS Sessions
      summary: Get QoS session information for a device
      description: |
        Querying for QoS session resource information details for a device

        **NOTES:**
        - The access token may be either 2-legged or 3-legged.
          - If a 3-legged access token is used, the subject associated with the session must also be associated with the access token. In this case the optional `device` parameter MUST NOT be provided in the request.
          - If a 2-legged access token is used, the device parameter must be provided and identify a device.
        - The session must have been created by the same API consumer given in the access token
        - If no QoS session is found for the requested device, an empty array is returned.
        - This call uses the POST method instead of GET to comply with the CAMARA Commonalities guidelines for sending sensitive or complex data in API calls. Since the device field may contain personally identifiable information, it should not be sent via GET.
          [CAMARA API Design Guidelines](https://github.com/camaraproject/Commonalities/blob/r3.3/documentation/CAMARA-API-Design-Guide.md#65-post-or-get-for-transferring-sensitive-or-complex-data)
      operationId: retrieveSessionsByDevice
      parameters:
        - $ref: '#/components/parameters/x-correlator'
      requestBody:
        description: Parameters to get QoS session information by device
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RetrieveSessionsInput'
        required: true
      responses:
        '200':
          description: Returns the QoS sessions information for a given device. A device may have multiple sessions, thus the response is an array. An empty array is returned if no sessions are found.
          headers:
            x-correlator:
              $ref: '#/components/headers/x-correlator'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveSessionsOutput'
              examples:
                RETRIEVE_SESSIONS_ONE_ITEM:
                  $ref: '#/components/examples/RETRIEVE_SESSIONS_EXAMPLE'
                RETRIEVE_SESSIONS_NO_ITEMS:
                  $ref: '#/components/examples/RETRIEVE_SESSIONS_EMPTY_EXAMPLE'
        '400':
          $ref: '#/components/responses/Generic400'
        '401':
          $ref: '#/components/responses/Generic401'
        '403':
          $ref: '#/components/responses/Generic403'
        '404':
          $ref: '#/components/responses/GenericDevice404'
        '422':
          $ref: '#/components/responses/Generic422'
        '429':
          $ref: '#/components/responses/Generic429'
      security:
        - openId:
            - quality-on-demand:sessions:retrieve-by-device
components:
  x-camara-entitlements:
    connected-network-type-subscriptions:
      org.camaraproject.connected-network-type-subscriptions.v1.network-type-changed:
        required:
          scopes:
            - camara-cloudevents-subscriptions:org.camaraproject.camara-cloudevents-subscriptions.v0.common:create
          roles:
            - connected-network:notify
          authorization_details:
            - type: cloudevents-subscription
              service: connected-network-type
              actions:
                - create
              event_types:
                - network-type-changed
            - type: cloudevents-subscription
              service: connected-network-type
              actions:
                - read
              event_types:
                - network-type-changed
            - type: cloudevents-subscription
              service: connected-network-type
              actions:
                - delete
              event_types:
                - network-type-changed
    geofencing-subscriptions:
      org.camaraproject.geofencing-subscriptions.v1.area:
        required:
          scopes:
            - camara-cloudevents-subscriptions:org.camaraproject.camara-cloudevents-subscriptions.v0.common:create
          roles:
            - geofencing:notify
          authorization_details:
            - type: cloudevents-subscription
              service: geofencing
              actions:
                - create
              event_types:
                - area-entered
            - type: cloudevents-subscription
              service: geofencing
              actions:
                - create
              event_types:
                - area-left
            - type: cloudevents-subscription
              service: geofencinge
              actions:
                - read
              event_types:
                - area
            - type: cloudevents-subscription
              service: geofencing
              actions:
                - delete
              event_types:
                - area
  securitySchemes:
    openId:
      description: OpenID Connect authentication.
      type: openIdConnect
      openIdConnectUrl: https://example.com/.well-known/openid-configuration
    notificationsBearerAuth:
      description: Notification bearer authentication.
      type: http
      scheme: bearer
      bearerFormat: '{$request.body#/sinkCredential.credentialType}'
  schemas:
    CamaraExtendedCloudEventsAttribute:
      type: object
      description: |
        Extended CloudEvents defined attributes for CAMARA.
        'https://raw.githubusercontent.com/cloudevents/spec/main/subscriptions/subscriptions-openapi.yaml#/components/schemas/CloudEventsAttribute'

        Required properties are as follows:
        - id
        - source
        - specversion
        - type
        - time

        'datacontenttype': 'media-type that describes the event payload encoding, must be "application/json" for CAMARA APIs'
        'type' example: org.camaraproject.device-reachability-status-subscriptions.v0.reachability-data
      allOf:
        - $ref: '#/components/schemas/CloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/CamaraCloudEventData'
            camaraConfigVersion:
              type: string
              description: Opaque version or hash of the effective subscription config
      required:
        - id
        - source
        - specversion
        - type
        - time
        - data
      discriminator:
        propertyName: type
    org.camaraproject.connected-network-type-subscriptions.v1.detail:
      description: The detail of the requested event subscription.
      type: object
      allOf:
        - $ref: '#/components/schemas/SubscriptionDetail'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
          required:
            - device
          additionalProperties: false
    org.camaraproject.connected-network-type-subscriptions.v1.network-type-changed:
      description: event structure for network type change
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.connected-network-type-subscriptions.v1.network-type-changed.data'
          required:
            - data
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.connected-network-type-subscriptions.v1.network-type-changed
        specversion: '1.0'
        datacontenttype: application/json
        data:
          subscriptionId: '987654321'
          device:
            phoneNumber: '+123456789'
          connectedNetworkType: 5G
        time: '2023-03-22T05:40:23.682Z'
    org.camaraproject.connected-network-type-subscriptions.v1.subscription-ends:
      description: event structure for event subscription ends
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.connected-network-type-subscriptions.v1.subscription-ends.data'
          required:
            - data
      example:
        id: '124003'
        source: https://dataUsageServer.supertelco.com
        type: org.camaraproject.connected-network-type-subscriptions.v1.subscription-ends
        specversion: '1.0'
        datacontenttype: application/json
        data:
          device:
            phoneNumber: '+123456789'
          terminationReason: SUBSCRIPTION_EXPIRED
          subscriptionId: dv10-h556-rt89-1403
          terminationDescription: Subscription expiry time has been reached
        time: '2024-03-05T15:00:23.682Z'
    org.camaraproject.geofencing-subscriptions.v1.detail:
      description: The detail of the requested event subscription.
      type: object
      allOf:
        - $ref: '#/components/schemas/SubscriptionDetail'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
            area:
              $ref: '#/components/schemas/Area'
          required:
            - area
          additionalProperties: false
    org.camaraproject.geofencing-subscriptions.v1.area-left:
      description: Event structure for event when the devices leaves the areas.
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.geofencing-subscriptions.v1.area-left.data'
          required:
            - data
          additionalProperties: false
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.geofencing-subscriptions.v1.area-left
        specversion: '1.0'
        datacontenttype: application/json
        time: '2023-03-22T05:40:23.682Z'
        data:
          subscriptionId: 987654321
          device:
            phoneNumber: 123456789
          area:
            areaType: CIRCLE
            center:
              latitude: 50.735851
              longitude: 7.10066
            radius: 2000
    org.camaraproject.geofencing-subscriptions.v1.area-entered:
      description: Event structure for event when the devices enters the areas.
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.geofencing-subscriptions.v1.area-entered.data'
          required:
            - data
          additionalProperties: false
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.geofencing-subscriptions.v1.area-entered
        specversion: '1.0'
        datacontenttype: application/json
        time: '2023-03-22T05:40:23.682Z'
        data:
          subscriptionId: 987654321
          device:
            phoneNumber: 123456789
          area:
            areaType: CIRCLE
            center:
              latitude: 50.735851
              longitude: 7.10066
            radius: 2000
    org.camaraproject.geofencing-subscriptions.v1.subscription-started:
      description: Event structure for event subscription started.
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.geofencing-subscriptions.v1.subscription-started.data'
          required:
            - data
          additionalProperties: false
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.geofencing-subscriptions.v1.subscription-started
        specversion: '1.0'
        datacontenttype: application/json
        time: '2023-03-22T05:40:23.682Z'
        data:
          subscriptionId: dv10-h556-rt89-1403
          initiationReason: SUBSCRIPTION_CREATED
          device:
            phoneNumber: 123456789
          area:
            areaType: CIRCLE
            center:
              latitude: 50.735851
              longitude: 7.10066
            radius: 2000
    org.camaraproject.geofencing-subscriptions.v1.subscription-updated:
      description: Event detail structure for subscription updated event
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.geofencing-subscriptions.v1.subscription-updated.data'
          required:
            - data
          additionalProperties: false
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.geofencing-subscriptions.v1.subscription-updated
        specversion: '1.0'
        datacontenttype: application/json
        time: '2023-03-22T05:40:23.682Z'
        data:
          subscriptionId: dv10-h556-rt89-1403
          updateReason: SUBSCRIPTION_ACTIVE
          device:
            phoneNumber: 123456789
          area:
            areaType: CIRCLE
            center:
              latitude: 50.735851
              longitude: 7.10066
            radius: 2000
    org.camaraproject.geofencing-subscriptions.v1.subscription-ended:
      description: Event structure for event subscription ended.
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.geofencing-subscriptions.v1.subscription-ended.data'
          required:
            - data
          additionalProperties: false
      example:
        id: '123655'
        source: https://notificationSendServer12.supertelco.com
        type: org.camaraproject.geofencing-subscriptions.v1.subscription-ended
        specversion: '1.0'
        datacontenttype: application/json
        time: '2023-03-22T05:40:23.682Z'
        data:
          subscriptionId: 987654321
          device:
            phoneNumber: 123456789
          area:
            areaType: CIRCLE
            center:
              latitude: 50.735851
              longitude: 7.10066
            radius: 2000
          terminationReason: SUBSCRIPTION_EXPIRED
    org.camaraproject.quality-on-demand.v1.detail:
      description: The detail of the requested event subscription.
      type: object
      allOf:
        - $ref: '#/components/schemas/SubscriptionDetail'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
          required:
            - device
          additionalProperties: false
    org.camaraproject.quality-on-demand.v1.qos-status-changed:
      description: Event structure for event when the device leaves the area.
      allOf:
        - $ref: '#/components/schemas/CamaraExtendedCloudEventsAttribute'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/org.camaraproject.quality-on-demand.v1.qos-status-changed.data'
          required:
            - data
          additionalProperties: false
      example:
        id: 83a0d986-0866-4f38-b8c0-fc65bfcda452
        source: https://api.example.com/qod/v1/sessions/123e4567-e89b-12d3-a456-426614174000
        specversion: '1.0'
        type: org.camaraproject.quality-on-demand.v1.qos-status-changed
        time: '2024-06-01T13:00:00Z'
        data:
          sessionId: 123e4567-e89b-12d3-a456-426614174000
          qosStatus: UNAVAILABLE
          statusInfo: DURATION_EXPIRED
    XCorrelator:
      type: string
      pattern: ^[a-zA-Z0-9-_:;.\/<>{}]{0,256}$
      example: b4333c46-49c0-4f62-80d7-f0ef930f1c46
    CamaraSubscriptionConfigCreateOnly:
      description: |
        Implementation-specific configuration parameters are needed by the subscription manager for acquiring events at POST.
        In CAMARA we have predefined attributes like `initialEvent`.
        Note: If a request is performed for several event types, all subscribed events will use the same `config` parameters.
      type: object
      additionalProperties: false
      properties:
        initialEvent:
          type: boolean
          description: |
            Set to `true` by API consumer if consumer wants to get an event as soon as the subscription is created and current situation reflects event request. It applies to all event types.
            Change request for this attribute using PUT or PATCH on existing subscription results in GENERIC_400_DISALLOWED_CHANGE error.
            Example: Consumer request area entered event. If consumer sets initialEvent to true and device is already in the geofence, an event is triggered.
    CamaraSubCreateOnly:
      type: object
      description: |
        Extended subscription request with enhanced config creation only options.
      properties:
        config:
          $ref: '#/components/schemas/CamaraSubscriptionConfigCreateOnly'
    Protocol:
      type: string
      enum:
        - HTTP
        - MQTT3
        - MQTT5
        - AMQP
        - NATS
        - KAFKA
      description: REQUIRED. Identifier of a delivery protocol.
      example: HTTP
    ProtocolSettings:
      type: object
      additionalProperties: false
    AMQPSettings:
      type: object
      allOf:
        - $ref: '#/components/schemas/ProtocolSettings'
        - properties:
            address:
              type: string
            linkName:
              type: string
            sendersettlementmode:
              type: string
              enum:
                - settled
                - unsettled
            linkProperties:
              type: object
              additionalProperties:
                type: string
    ApacheKafkaSettings:
      type: object
      allOf:
        - $ref: '#/components/schemas/ProtocolSettings'
        - properties:
            topicname:
              type: string
            partitionkeyextractor:
              type: string
            clientid:
              type: string
            ackmode:
              type: integer
          required:
            - topicname
    HTTPSettings:
      type: object
      allOf:
        - $ref: '#/components/schemas/ProtocolSettings'
        - properties:
            headers:
              type: object
              additionalProperties:
                type: string
            method:
              type: string
    MQTTSettings:
      type: object
      allOf:
        - $ref: '#/components/schemas/ProtocolSettings'
        - properties:
            topicname:
              type: string
            qos:
              type: integer
              format: int32
            retain:
              type: boolean
            expiry:
              type: integer
              format: int32
            userproperties:
              type: object
          required:
            - topicname
    NATSSettings:
      type: object
      allOf:
        - $ref: '#/components/schemas/ProtocolSettings'
        - properties:
            subject:
              type: string
          required:
            - subject
    SinkCredential:
      type: object
      properties:
        credentialtype:
          type: string
          enum:
            - PLAIN
            - ACCESSTOKEN
            - REFRESHTOKEN
          description: The type of the credential.
      additionalProperties: false
    AccessTokenCredential:
      type: object
      description: An access token credential.
      allOf:
        - $ref: '#/components/schemas/SinkCredential'
        - properties:
            accesstoken:
              description: REQUIRED. An access token is a previously acquired token granting access to the target resource.
              type: string
            accesstokenexpiresutc:
              type: string
              format: date-time
              description: RECOMMENDED. An absolute UTC instant at which the token shall be considered expired.
            accesstokentype:
              description: OPTIONAL. )Type of the access token (See https://tools.ietf.org/html/rfc6749#section-7.1).
              type: string
              default: bearer
          required:
            - accesstoken
            - accesstokenexpiresutc
    PlainCredential:
      type: object
      description: A plain credential as a combination of an identifier and a secret.
      allOf:
        - $ref: '#/components/schemas/SinkCredential'
        - properties:
            identifier:
              description: The identifier might be an account or username.
              type: string
            secret:
              description: The secret might be a password or passphrase.
              type: string
    RefreshTokenCredential:
      type: object
      description: An access token credential with a refresh token.
      allOf:
        - $ref: '#/components/schemas/AccessTokenCredential'
        - type: object
          properties:
            refreshtoken:
              description: REQUIRED. An refresh token credential used to acquire access tokens.
              type: string
            refreshtokenendpoint:
              type: string
              format: uri
              description: REQUIRED. A URL at which the refresh token can be traded for an access token.
      required:
        - refreshtoken
        - refreshtokenendpoint
    Filter:
      title: Filter
      description: A filter from a selection of multiple filter types and dialects
      type: object
      additionalProperties: true
    AllFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          description: all filter
          properties:
            all:
              description: This filter evaluates to 'true' if all contained filters are 'true'
              type: array
              minItems: 1
              items:
                title: Filter entry
                oneOf:
                  - $ref: '#/components/schemas/Filter'
                  - $ref: '#/components/schemas/AllFilter'
                  - $ref: '#/components/schemas/AnyFilter'
                  - $ref: '#/components/schemas/NotFilter'
                  - $ref: '#/components/schemas/ExactFilter'
                  - $ref: '#/components/schemas/PrefixFilter'
                  - $ref: '#/components/schemas/SuffixFilter'
                  - $ref: '#/components/schemas/SqlFilter'
          additionalProperties: false
    AnyFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          description: any filter
          properties:
            any:
              description: This filter evaluates to 'true' if any contained filters are 'true'
              type: array
              minItems: 1
              items:
                title: Filter entry
                oneOf:
                  - $ref: '#/components/schemas/Filter'
                  - $ref: '#/components/schemas/AllFilter'
                  - $ref: '#/components/schemas/AnyFilter'
                  - $ref: '#/components/schemas/NotFilter'
                  - $ref: '#/components/schemas/ExactFilter'
                  - $ref: '#/components/schemas/PrefixFilter'
                  - $ref: '#/components/schemas/SuffixFilter'
                  - $ref: '#/components/schemas/SqlFilter'
          additionalProperties: false
    NotFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          description: not filter
          properties:
            not:
              type: object
              oneOf:
                - $ref: '#/components/schemas/Filter'
                - $ref: '#/components/schemas/AllFilter'
                - $ref: '#/components/schemas/AnyFilter'
                - $ref: '#/components/schemas/NotFilter'
                - $ref: '#/components/schemas/ExactFilter'
                - $ref: '#/components/schemas/PrefixFilter'
                - $ref: '#/components/schemas/SuffixFilter'
                - $ref: '#/components/schemas/SqlFilter'
          additionalProperties: false
    CloudEventsAttribute:
      type: object
      description: CloudEvents defined attributes.
      additionalProperties:
        type: string
      properties:
        id:
          type: string
          description: Identifies the event.
        source:
          type: string
          description: Identifies the context in which an event happened.
        specversion:
          type: string
          description: The version of the CloudEvents specification which the event uses.
        type:
          type: string
          description: Describes the type of event related to the originating occurrence.
        datacontenttype:
          type: string
          description: Content type of the data value.
        dataschema:
          type: string
          description: Identifies the schema that data adheres to.
        subject:
          type: string
          description: Describes the subject of the event in the context of the event producer.
        time:
          type: string
          description: Timestamp of when the occurrence happened.
    ExactFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          title: exact filter
          description: This filter evaluates to 'true' if the 'value' exactly matches the value of the indicated CloudEvents context attribute
          properties:
            exact:
              $ref: '#/components/schemas/CloudEventsAttribute'
          additionalProperties: false
    PrefixFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          title: prefix filter
          description: This filter evaluates to 'true' if the 'value' is a prefix of the value of the indicated CloudEvents context attribute
          properties:
            prefix:
              $ref: '#/components/schemas/CloudEventsAttribute'
          additionalProperties: false
    SuffixFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          title: suffix filter
          description: This filter evaluates to 'true' if the 'value' is a suffix of the value of the indicated CloudEvents context attribute
          properties:
            suffix:
              $ref: '#/components/schemas/CloudEventsAttribute'
          additionalProperties: false
    SqlFilter:
      allOf:
        - $ref: '#/components/schemas/Filter'
        - type: object
          description: CESQL filter
          properties:
            sql:
              type: string
              description: The CESQL expression
          additionalProperties: true
    SubscriptionRequest:
      properties:
        protocol:
          $ref: '#/components/schemas/Protocol'
        protocolsettings:
          oneOf:
            - $ref: '#/components/schemas/ProtocolSettings'
            - $ref: '#/components/schemas/AMQPSettings'
            - $ref: '#/components/schemas/ApacheKafkaSettings'
            - $ref: '#/components/schemas/HTTPSettings'
            - $ref: '#/components/schemas/MQTTSettings'
            - $ref: '#/components/schemas/NATSSettings'
        sink:
          type: string
          format: url
          description: REQUIRED. The address to which events shall be delivered using the selected protocol.
          example: https://endpoint.example.com/webhook
        sinkcredential:
          oneOf:
            - $ref: '#/components/schemas/SinkCredential'
            - $ref: '#/components/schemas/AccessTokenCredential'
            - $ref: '#/components/schemas/PlainCredential'
            - $ref: '#/components/schemas/RefreshTokenCredential'
        source:
          type: string
          format: uri-reference
          description: OPTIONAL. Source to which the subscription applies. May be implied by the request address.
        types:
          description: CloudEvent types eligible to be delivered by this subscription
          type: array
          items:
            type: string
        filters:
          description: This filter evaluates to 'true' if all contained filters are 'true'
          type: array
          items:
            title: Filter entry
            oneOf:
              - $ref: '#/components/schemas/Filter'
              - $ref: '#/components/schemas/AllFilter'
              - $ref: '#/components/schemas/AnyFilter'
              - $ref: '#/components/schemas/NotFilter'
              - $ref: '#/components/schemas/ExactFilter'
              - $ref: '#/components/schemas/PrefixFilter'
              - $ref: '#/components/schemas/SuffixFilter'
              - $ref: '#/components/schemas/SqlFilter'
        config:
          description: OPTIONAL. Implementation-specific configuration parameters needed by the subscription manager for acquiring events.
          type: object
          additionalProperties:
            type: string
      required:
        - sink
        - protocol
    SubscriptionDetail:
      type: object
      description: Base schema for all domain-specific subscriptionDetail definitions.
    PhoneNumber:
      description: A public identifier addressing a telephone subscription. In mobile networks it corresponds to the MSISDN (Mobile Station International Subscriber Directory Number). In order to be globally unique it has to be formatted in international format, according to E.164 standard, prefixed with '+'.
      type: string
      pattern: ^\+[1-9][0-9]{4,14}$
      example: '+123456789'
    NetworkAccessIdentifier:
      description: A public identifier addressing a subscription in a mobile network. In 3GPP terminology, it corresponds to the GPSI formatted with the External Identifier ({Local Identifier}@{Domain Identifier}). Unlike the telephone number, the network access identifier is not subjected to portability ruling in force, and is individually managed by each operator.
      type: string
      example: 123456789@example.com
    SingleIpv4Addr:
      description: A single IPv4 address with no subnet mask
      type: string
      format: ipv4
      example: 84.125.93.10
    Port:
      description: TCP or UDP port number
      type: integer
      minimum: 0
      maximum: 65535
    DeviceIpv4Addr:
      type: object
      description: |
        The device should be identified by either the public (observed) IP address and port as seen by the application server, or the private (local) and any public (observed) IP addresses in use by the device (this information can be obtained by various means, for example from some DNS servers).

        If the allocated and observed IP addresses are the same (i.e. NAT is not in use) then  the same address should be specified for both publicAddress and privateAddress.

        If NAT64 is in use, the device should be identified by its publicAddress and publicPort, or separately by its allocated IPv6 address (field ipv6Address of the Device object)

        In all cases, publicAddress must be specified, along with at least one of either privateAddress or publicPort, dependent upon which is known. In general, mobile devices cannot be identified by their public IPv4 address alone.
      properties:
        publicAddress:
          $ref: '#/components/schemas/SingleIpv4Addr'
        privateAddress:
          $ref: '#/components/schemas/SingleIpv4Addr'
        publicPort:
          $ref: '#/components/schemas/Port'
      anyOf:
        - required:
            - publicAddress
            - privateAddress
        - required:
            - publicAddress
            - publicPort
      example:
        publicAddress: 84.125.93.10
        publicPort: 59765
    DeviceIpv6Address:
      description: |
        The device should be identified by the observed IPv6 address, or by any single IPv6 address from within the subnet allocated to the device (e.g. adding ::0 to the /64 prefix).
      type: string
      format: ipv6
      example: 2001:db8:85a3:8d3:1319:8a2e:370:7344
    Device:
      description: |
        End-user equipment able to connect to a mobile network. Examples of devices include smartphones or IoT sensors/actuators.
            The developer can choose to provide the below specified device identifiers:
            * `ipv4Address`
            * `ipv6Address`
            * `phoneNumber`
            * `networkAccessIdentifier`
            NOTE1: the network operator might support only a subset of these options. The API invoker can provide multiple identifiers to be compatible across different network operators. In this case the identifiers MUST belong to the same device.
            NOTE2: as for this Commonalities release, we are enforcing that the networkAccessIdentifier is only part of the schema for future-proofing, and CAMARA does not currently allow its use. After the CAMARA meta-release work is concluded and the relevant issues are resolved, its use will need to be explicitly documented in the guidelines.
      type: object
      properties:
        phoneNumber:
          $ref: '#/components/schemas/PhoneNumber'
        networkAccessIdentifier:
          $ref: '#/components/schemas/NetworkAccessIdentifier'
        ipv4Address:
          $ref: '#/components/schemas/DeviceIpv4Addr'
        ipv6Address:
          $ref: '#/components/schemas/DeviceIpv6Address'
      minProperties: 1
    Area:
      description: Base schema for all areas
      type: object
      properties:
        areaType:
          $ref: '#/components/schemas/AreaType'
      required:
        - areaType
      discriminator:
        propertyName: areaType
        mapping:
          CIRCLE: '#/components/schemas/Circle'
          POLYGON: '#/components/schemas/Polygon'
    Latitude:
      description: Latitude component of a location
      type: number
      format: double
      minimum: -90
      maximum: 90
    Longitude:
      description: Longitude component of location
      type: number
      format: double
      minimum: -180
      maximum: 180
    Point:
      type: object
      description: Coordinates (latitude, longitude) defining a location in a map
      required:
        - latitude
        - longitude
      properties:
        latitude:
          $ref: '#/components/schemas/Latitude'
        longitude:
          $ref: '#/components/schemas/Longitude'
      example:
        latitude: 50.735851
        longitude: 7.10066
    Circle:
      description: Circular area
      allOf:
        - $ref: '#/components/schemas/Area'
        - type: object
          required:
            - center
            - radius
          properties:
            center:
              $ref: '#/components/schemas/Point'
            radius:
              type: number
              description: Distance from the center in meters
              minimum: 1
    PointList:
      description: List of points defining a polygon
      type: array
      items:
        $ref: '#/components/schemas/Point'
      minItems: 3
      maxItems: 15
    Polygon:
      description: Polygonal area. The Polygon should be a simple polygon, i.e. should not intersect itself.
      allOf:
        - $ref: '#/components/schemas/Area'
        - type: object
          required:
            - boundary
          properties:
            boundary:
              $ref: '#/components/schemas/PointList'
    AreaType:
      type: string
      description: |
        Type of this area.
        CIRCLE - The area is defined as a circle.
        POLYGON - The area is defined as a polygon.
      enum:
        - CIRCLE
        - POLYGON
    GroupId:
      description: Reference Id for a created group
      type: string
      format: uuid
    PortsSpec:
      description: Specification of several TCP or UDP ports
      type: object
      minProperties: 1
      properties:
        ranges:
          description: Range of TCP or UDP ports
          type: array
          minItems: 1
          items:
            type: object
            required:
              - from
              - to
            properties:
              from:
                $ref: '#/components/schemas/Port'
              to:
                $ref: '#/components/schemas/Port'
        ports:
          description: Array of TCP or UDP ports
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/Port'
      example:
        ranges:
          - from: 5010
            to: 5020
        ports:
          - 5060
          - 5070
    ResourceScopes:
      description: A list of resource scopes
      type: array
      items:
        oneOf:
          - $ref: '#/components/schemas/Device'
          - $ref: '#/components/schemas/Area'
          - $ref: '#/components/schemas/GroupId'
          - $ref: '#/components/schemas/PortsSpec'
    NotificationPolicy:
      description: |
        CloudEvents notification delivery policy.
      type: object
      properties:
        periodicityResourceScopes:
          $ref: '#/components/schemas/ResourceScopes'
        periodicity:
          type: string
          description: |
            ISO-8601 duration indicating the **scheduled emission cadence** for this subscription.
            When present, the server creates a scheduler that emits events on each tick until
            `subscriptionExpireTime` or explicit deletion.

            Semantics:
              - Omitted  no scheduler (pure event-driven behavior).
              - Example values:
                  `PT1H`   every 1 hour
                  `PT15M`  every 15 minutes
                  `P1D`    once per day
              - The first tick is determined by `subscriptionStartTime` and optional `alignment`.
              - The CloudEvent `time` reflects the scheduled tick instant.
          example: PT1H
          nullable: true
        alignment:
          type: string
          format: date-time
          description: |
            Optional **anchor timestamp** to align ticks to a wall-clock boundary.
            If provided with `periodicity: PT1H`, ticks align to the top of the hour relative
            to this anchor (e.g., 12:00, 13:00, 14:00). If omitted, the first tick occurs
            at or after `subscriptionStartTime` and subsequent ticks follow `periodicity`.

            Notes:
              - If `subscriptionStartTime` < now and `alignment` is set, the next tick is the
                first aligned instant  now.
              - Must be RFC 3339/ISO 8601 timestamp.
          example: '2025-10-29T12:00:00Z'
          nullable: true
        eventMode:
          type: string
          enum:
            - snapshot
            - changes
            - digest
          default: snapshot
          description: |
            Controls **what** is emitted on each scheduled tick when `periodicity` is present.
              - `snapshot`  emit the current state for the selected `resourceScopes` every tick,
                even if no changes occurred.
              - `changes`   emit only if any relevant state changed since the previous tick
                (implementations MAY send a minimal heartbeat with `data.noChange: true`).
              - `digest`    emit an **aggregate** for the interval (see `window`).

            If `periodicity` is omitted, `eventMode` has no effect.
          nullable: true
        window:
          type: string
          description: |
            ISO-8601 duration that defines the **aggregation interval** used when
            `eventMode: digest` is selected. Defaults to `periodicity` if not provided.

            Examples:
              - With `periodicity: PT1H` and `window: PT1H`, emit hourly roll-ups.
              - With `periodicity: PT1H` and `window: P1D`, emit a daily roll-up once per hour
                (implementations MAY coalesce and emit only on the window boundary).

            Ignored for `snapshot` and `changes`.
          example: PT1H
          nullable: true
        maxEventsPerTick:
          type: integer
          minimum: 1
          description: |
            Maximum number of CloudEvents the server may emit per scheduled tick
            for this subscription. Used to limit fan-out when the referenced
            `resourceScopes` include many resources (for example, a large device group).

            Semantics:
              - When omitted, the server uses its own internal batching policy.
              - When provided, the server SHOULD partition the dataset and deliver
                up to `maxEventsPerTick` events per tick, adding `data.part` /
                `data.partCount` metadata to each CloudEvent for reassembly.
              - This property has effect only when `periodicity` is set.

            Example:
              `maxEventsPerTick: 100`  emit up to 100 events each hour per tick.
          example: 100
          nullable: true
        deliveryMode:
          type: string
          description: |
            Defines **when** the subscription server delivers notifications
            relative to event occurrence and policy evaluation.

            - `IMMEDIATE`: deliver each qualifying event as soon as it is produced
              (default CAMARA behavior, equivalent to real-time push).
            - `PERIODIC`: deliver accumulated or aggregated results on a fixed cadence
              defined by `periodicity` and optionally aligned using `alignment`.
          enum:
            - IMMEDIATE
            - PERIODIC
          default: IMMEDIATE
          nullable: true
    CamaraSubscriptionConfigUpdatable:
      description: |
        Implementation-specific configuration parameters are needed by the subscription manager for acquiring events at POST, PUT or PATCH.
        In CAMARA we have predefined attributes like `subscriptionExpireTime`, `subscriptionMaxEvents`.
        Specific event type attributes must be defined in `subscriptionDetails`.
        Note: If a request is performed for several event types, all subscribed events will use the same `config` parameters.
      type: object
      additionalProperties: false
      required:
        - subscriptionDetails
      properties:
        subscriptionDetails:
          type: array
          description: Base schema for all domain-specific subscriptionDetail definitions.
          nullable: true
          minItems: 1
          maxItems: 100
          items:
            type: object
            additionalProperties: false
            required:
              - types
              - version
              - details
            properties:
              types:
                type: array
                minItems: 1
                maxItems: 100
                items:
                  type: string
                  description: subscription detail types eligible to be delivered by this subscription.
                example:
                  - org.camaraproject.quality-on-demand.v1.detail
                  - org.camaraproject.geofencing-subscriptions.v1.detail
              version:
                type: string
                description: Version number for this subscription detail.
              details:
                type: array
                minItems: 1
                maxItems: 100
                description: Domain-specific attributes for the indicated subscription detail types.
                items:
                  $ref: '#/components/schemas/SubscriptionDetail'
        subscriptionStartTime:
          type: string
          format: date-time
          example: '2023-01-17T13:18:23.682Z'
          description: The subscription start time (in date-time format) requested by the API consumer.
          nullable: true
        subscriptionExpireTime:
          type: string
          format: date-time
          example: '2023-01-17T13:18:23.682Z'
          description: The subscription expiration time (in date-time format) requested by the API consumer. Set this attribute to a time value in the past results in GENERIC_400_DENIED_CHANGE error.
          nullable: true
        subscriptionMaxEvents:
          type: integer
          description: |
            Identifies the maximum total number of event reports to be generated (>=1) requested by the API consumer - Once this number is reached, the subscription ends.
            Note on combined usage of `initialEvent` and `subscriptionMaxEvents`:
            If an event is triggered following `initialEvent` set to `true`, this event will be counted towards `subscriptionMaxEvents`.
            It is not per event type and it is not batch count.
          nullable: true
          minimum: 1
          example: 5
        eventBatchSize:
          type: integer
          description: |
            Identifies the maximum number of event reports to be generated (>=1) ina a batch requested by the API consumer - Once this number is reached for current batch, the events emit to the 'sink'.
            Batching: Events are pushed in batches of up to config.eventBatchSize.
          nullable: true
          minimum: 1
          example: 5
        cacheResyncRequest:
          type: boolean
          description: |
            Set to `true` by API consumer if consumer wants to get cached state as soon as the subscription is created.
            A cache resync isn't a request for historical event data. It only restores the current cache state.

            Treat a cache resync request as if 'initialEvent' = 'true' and 'subscriptionStartTime' is now. 'eventResyncTime' value, if provided, is ignored by cache resync operation.
          nullable: true
        eventResyncTime:
          type: string
          format: date-time
          example: '2023-01-17T13:18:23.682Z'
          description: The event resync start time (in date-time format) requested by the API consumer.
          nullable: true
        eventResyncRequest:
          type: boolean
          description: |
            Set to `true` by API consumer if consumer wants to get historical events as soon as the subscription is created.
            Treat the event resync request as if 'initialEvent' = 'true' and use the provided 'eventResyncTime' in place of 'subscriptionStartTime'.

            Event resync becomes truly historical only if the system retains every event and can replay them all.
            In practice, we should treat event resync as a best effort operation, dependent on what the implementation can actually provide.
            Not every API needs or should offer a batching/resync capability.
          nullable: true
        notificationPolicy:
          $ref: '#/components/schemas/NotificationPolicy'
    CamaraSubUpdatable:
      type: object
      description: |
        Extended subscription enhanced config updatable options at POST and change later.
      allOf:
        - $ref: '#/components/schemas/SubscriptionRequest'
        - type: object
          properties:
            config:
              $ref: '#/components/schemas/CamaraSubscriptionConfigUpdatable'
      required:
        - types
        - config
    SubscriptionId:
      type: string
      description: |
        The unique identifier of the subscription in the scope of the subscription manager. When this information is contained
        within an event notification, this concept SHALL be referred as `subscriptionId` as per [Commonalities Event Notification
        Model](https://github.com/camaraproject/Commonalities/blob/main/documentation/API-design-guidelines.md#122-event-notification).
      example: qs15-h556-rt89-1298
    CamaraSubscriptionConfigOutputOnly:
      description: |
        Implementation-specific configuration parameters output from the subscription manager for acquiring events.
      type: object
      additionalProperties: false
      properties:
        startsAt:
          type: string
          format: date-time
          description: Date when the event subscription will begin/began. This attribute must not be present in the POST request as it is provided by API server. It must be present in GET endpoints.
        expiresAt:
          type: string
          format: date-time
          description: |
            Date when the event subscription will expire. Only provided when `subscriptionExpireTime` is indicated by API client or Telco Operator has a specific policy about that.
            This attribute must not be present in the POST request as it is provided (optionally) by API server.
            This attribute must be provided by the server if subscriptionExpireTime is provided in the request and server is not able to handle it.
          nullable: true
        status:
          type: string
          description: |-
            Current overall status of the subscription - Management of Subscription State engine is not mandatory for now. It is not per event type being subscribed to. Note not all statuses may be considered to be implemented. Details:
              - `ACTIVATION_REQUESTED`: Subscription creation (POST) is triggered but subscription creation process is not finished yet and validation handshake maybe is pending per CloudEvents HTTP WebHook.
              - `CACHE_RESYNCING`: current cache state restore in progress.
              - `CACHE_RESYNC_COMPLETED`: current cache state restored.
              - `EVENT_RESYNCING`: historical events replay in progress.
              - `EVENT_RESYNC_COMPLETED`: historical events replay completed.
              - `ACTIVE`: Subscription creation process is completed. Subscription is fully operative.
              - `EXPIRED`: Subscription is ended (no longer active). This status applies when subscription is ended due to `SUBSCRIPTION_EXPIRED` or `ACCESS_TOKEN_EXPIRED` event.
              - `DELETED`: Subscription is ended as deleted (no longer active). This status applies when subscription information is kept (i.e. subscription workflow is no longer active but its meta-information is kept).
          enum:
            - ACTIVATION_REQUESTED
            - CACHE_RESYNCING
            - CACHE_RESYNC_COMPLETED
            - EVENT_RESYNCING
            - EVENT_RESYNC_COMPLETED
            - ACTIVE
            - EXPIRED
            - DELETED
          nullable: true
    CamaraSubOutputOnly:
      type: object
      description: |
        Extended subscription output only attribute.
      properties:
        id:
          $ref: '#/components/schemas/SubscriptionId'
        config:
          $ref: '#/components/schemas/CamaraSubscriptionConfigOutputOnly'
    CamaraExtendedSubscription:
      type: object
      additionalProperties: false
      title: CamaraExtendedSubscription
      description: |
        Camara extended subscription.
      allOf:
        - $ref: '#/components/schemas/CamaraSubCreateOnly'
        - $ref: '#/components/schemas/CamaraSubUpdatable'
        - $ref: '#/components/schemas/CamaraSubOutputOnly'
    ErrorInfo:
      type: object
      required:
        - status
        - code
        - message
      properties:
        status:
          type: integer
          description: HTTP response status code
        code:
          type: string
          description: A human-readable code to describe the error
        message:
          type: string
          description: A human-readable description of what the event represents
    CamaraExtendedSubscriptionRequest:
      type: object
      description: |
        Extended subscription create request with enhanced config options.
      allOf:
        - $ref: '#/components/schemas/CamaraSubCreateOnly'
        - $ref: '#/components/schemas/CamaraSubUpdatable'
    SubscriptionAsync:
      description: Response for an event-type subscription request managed asynchronously (Creation or Deletion).
      type: object
      properties:
        id:
          $ref: '#/components/schemas/SubscriptionId'
      required:
        - id
    CamaraCloudEventData:
      type: object
      description: Event details payload described in each CAMARA API and referenced by its type
      nullable: true
      additionalProperties: true
      properties:
        syncStatus:
          type: string
          enum:
            - CACHE_RESYNCING
            - CACHE_RESYNC_COMPLETED
            - EVENT_RESYNCING
            - EVENT_RESYNC_COMPLETED
          description: |
            Optional. If present, indicates the subscription's sync phase:
            - `CACHE_RESYNCING`: current cache state restore in progress.
            - `CACHE_RESYNC_COMPLETED`: current cache state restored.
            - `EVENT_RESYNCING`: historical events replay in progress.
            - `EVENT_RESYNC_COMPLETED`: historical events replay completed.
        camaraMeta:
          type: object
          description: |
            CAMARA-reserved metadata that augments domain payloads with scheduling,
            batching, and reassembly hints. Vendors SHOULD place platform-level
            metadata here to avoid collisions with domain fields.
          additionalProperties: false
          properties:
            periodic:
              type: object
              description: Metadata for periodic/partitioned emissions.
              additionalProperties: false
              properties:
                noChange:
                  type: boolean
                  description: |
                    True if no relevant state changed during this tick. Indicates a heartbeat event.
                  example: true
                part:
                  type: integer
                  minimum: 1
                  description: 1-based index of this part among multiple parts for the same tick.
                  example: 1
                partCount:
                  type: integer
                  minimum: 1
                  description: Total number of parts emitted for this tick.
                  example: 3
                tickTime:
                  type: string
                  format: date-time
                  description: |
                    Scheduled tick timestamp (should match CloudEvent `time`), useful for reassembly and dedupe.
                  example: '2025-10-29T13:00:00Z'
    CamaraConfigChangeEventBase:
      allOf:
        - $ref: '#/components/schemas/SubscriptionId'
        - type: object
          properties:
            camaraConfigBaseVersion:
              type: string
              description: Version/ETag this change applies to.
            camaraConfigResultVersion:
              type: string
              description: Version/ETag after applying this change.
            camaraSeq:
              type: string
              description: Monotonic sequence per subscription (provider-defined).
    JsonPatchBase:
      description: JSON patch base
      type: object
      required:
        - op
        - path
      properties:
        path:
          type: string
          description: JSON Pointer
    JsonPatchNeedsValue:
      description: JSON value patch
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonPatchBase'
        - type: object
          properties:
            op:
              type: string
              enum:
                - add
                - replace
                - test
            value: {}
          required:
            - op
            - value
    JsonPatchNeedsFrom:
      description: JSON from patch
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonPatchBase'
        - type: object
          properties:
            op:
              type: string
              enum:
                - move
                - copy
            from:
              type: string
              description: JSON Pointer source
          required:
            - op
            - from
    JsonPatchRemove:
      description: JSON remove patch
      type: object
      allOf:
        - $ref: '#/components/schemas/JsonPatchBase'
        - type: object
          properties:
            op:
              type: string
              enum:
                - remove
    CamaraExtendedJsonPatchOperation:
      description: |
        Extended subscription request with RFC 6902 operation.
      type: array
      items:
        oneOf:
          - $ref: '#/components/schemas/JsonPatchNeedsValue'
          - $ref: '#/components/schemas/JsonPatchNeedsFrom'
          - $ref: '#/components/schemas/JsonPatchRemove'
    CamaraConfigChangeEventJsonPatch:
      allOf:
        - $ref: '#/components/schemas/CamaraConfigChangeEventBase'
        - type: object
          properties:
            datacontenttype:
              type: string
              enum:
                - application/json-patch+json
            data:
              type: array
              description: JSON Patch operations applied to the *Subscription* representation (root at '/').
              items:
                $ref: '#/components/schemas/CamaraExtendedJsonPatchOperation'
    CamaraConfigChangeEventMergePatch:
      allOf:
        - $ref: '#/components/schemas/CamaraConfigChangeEventBase'
        - type: object
          properties:
            datacontenttype:
              type: string
              enum:
                - application/merge-patch+json
            data:
              $ref: '#/components/schemas/CamaraExtendedSubscription'
    CamaraConfigChangeEventSnapshot:
      allOf:
        - $ref: '#/components/schemas/CamaraConfigChangeEventBase'
        - type: object
          properties:
            datacontenttype:
              type: string
              enum:
                - application/json
            data:
              type: object
              required:
                - previous
                - current
              properties:
                previous:
                  $ref: '#/components/schemas/CamaraExtendedSubscription'
                current:
                  $ref: '#/components/schemas/CamaraExtendedSubscription'
    CamaraSubscriptionConfigUpdateOnly:
      description: |
        Implementation-specific configuration parameters are needed by the subscription manager for acquiring events at PUT or PATCH after POST.
        Note: If a request is performed for several event types, all subscribed events will use the same `config` parameters.
      type: object
      additionalProperties: false
      properties:
        status:
          type: string
          description: |-
            Current overall status of the subscription - Management of Subscription State engine is not mandatory for now. It is not per event type being subscribed to. Note not all statuses may be considered to be implemented. Details:
              - `ACTIVE`: Subscription creation process is completed. Subscription is fully operative.
              - `INACTIVE`: Subscription is temporarily inactive, but its workflow logic is not deleted.
          enum:
            - ACTIVE
            - INACTIVE
    CamaraSubUpdateOnly:
      type: object
      description: |
        Extended subscription enhanced config update only options. It toggles only meaningful post-creation option.
      properties:
        config:
          $ref: '#/components/schemas/CamaraSubscriptionConfigUpdateOnly'
    CamaraExtendedSubscriptionMergePatch:
      type: object
      additionalProperties: true
      description: JSON Merge Patch (RFC 7396) over the set of fields that are mutable post-creation. Only UpdateOnly and Updatable. Everything optional + nullable, per RFC 7396.
      allOf:
        - $ref: '#/components/schemas/CamaraSubUpdateOnly'
        - $ref: '#/components/schemas/CamaraSubUpdatable'
    ApplicationServerIpv4Address:
      type: string
      example: 198.51.100.0/24
      description: |
        IPv4 address may be specified in form <address/mask> as:
          - address - an IPv4 number in dotted-quad form 1.2.3.4. Only this exact IP number will match the flow control rule.
          - address/mask - an IP number as above with a mask width of the form 1.2.3.4/24.
            In this case, all IP numbers from 1.2.3.0 to 1.2.3.255 will match. The bit width MUST be valid for the IP version.
    ApplicationServerIpv6Address:
      type: string
      example: 2001:db8:85a3:8d3:1319:8a2e:370:7344
      description: |
        IPv6 address may be specified in form <address/mask> as:
          - address - The /128 subnet is optional for single addresses:
            - 2001:db8:85a3:8d3:1319:8a2e:370:7344
            - 2001:db8:85a3:8d3:1319:8a2e:370:7344/128
          - address/mask - an IP v6 number with a mask:
            - 2001:db8:85a3:8d3::0/64
            - 2001:db8:85a3:8d3::/64
    ApplicationServer:
      description: |
        A server hosting backend applications to deliver some business logic to clients.

        The developer can choose to provide the below specified device identifiers:

        * `ipv4Address`
        * `ipv6Address`
      type: object
      properties:
        ipv4Address:
          $ref: '#/components/schemas/ApplicationServerIpv4Address'
        ipv6Address:
          $ref: '#/components/schemas/ApplicationServerIpv6Address'
      minProperties: 1
    QosProfileName:
      description: |
        A unique name for identifying a specific QoS profile.
        This may follow different formats depending on the API provider implementation.
        Some options addresses:
          - A UUID style string
          - Support for predefined profiles QOS_S, QOS_M, QOS_L, and QOS_E
          - A searchable descriptive name
        The set of QoS Profiles that an API provider is offering may be retrieved by means of the QoS Profile API (qos-profile) or agreed on onboarding time.
      type: string
      example: voice
      minLength: 3
      maxLength: 256
      format: string
      pattern: ^[a-zA-Z0-9_.-]+$
    BaseSessionInfo:
      description: Common attributes of a QoD session
      type: object
      properties:
        device:
          $ref: '#/components/schemas/Device'
        applicationServer:
          $ref: '#/components/schemas/ApplicationServer'
        devicePorts:
          description: The ports used locally by the device for flows to which the requested QoS profile should apply. If omitted, then the qosProfile will apply to all flows between the device and the specified application server address and ports
          allOf:
            - $ref: '#/components/schemas/PortsSpec'
        applicationServerPorts:
          description: A list of single ports or port ranges on the application server
          allOf:
            - $ref: '#/components/schemas/PortsSpec'
        qosProfile:
          $ref: '#/components/schemas/QosProfileName'
        subscriptionRequest:
          $ref: '#/components/schemas/CamaraExtendedSubscriptionRequest'
      required:
        - applicationServer
        - qosProfile
    CreateSession:
      description: Attributes required to create a session
      allOf:
        - $ref: '#/components/schemas/BaseSessionInfo'
        - type: object
          properties:
            duration:
              description: |
                Requested session duration in seconds. Value may be explicitly limited for the QoS profile, as specified in the Qos Profile (see qos-profile API). Implementations can grant the requested session duration or set a different duration, based on network policies or conditions.
              type: integer
              format: int32
              minimum: 1
              example: 3600
          required:
            - duration
      additionalProperties: false
    SessionId:
      description: Session ID in UUID format
      type: string
      format: uuid
    QosStatus:
      description: |
        The current status of the requested QoS session. The status can be one of the following:
        * `REQUESTED` - QoS has been requested by creating a session
        * `AVAILABLE` - The requested QoS has been provided by the network
        * `UNAVAILABLE` - The requested QoS cannot be provided by the network due to some reason
      type: string
      enum:
        - REQUESTED
        - AVAILABLE
        - UNAVAILABLE
    StatusInfo:
      description: |
        Reason for the new `qosStatus`. Currently `statusInfo` is only applicable when `qosStatus` is 'UNAVAILABLE'.
        * `DURATION_EXPIRED` - Session terminated due to requested duration expired
        * `NETWORK_TERMINATED` - Network terminated the session before the requested duration expired
        * `DELETE_REQUESTED`- User requested the deletion of the session before the requested duration expired
      type: string
      enum:
        - DURATION_EXPIRED
        - NETWORK_TERMINATED
        - DELETE_REQUESTED
    SessionInfo:
      description: |
        Session related information returned in responses.
        Note that the device object is defined as optional and will only to be returned if provided in createSession. If more than one type of device identifier was provided, only one identifier will be returned (at implementation choice and with the original value provided in createSession).
        Please note that IP addresses of devices can change and get reused, so the original values may no longer identify the same device. They identified the device at the time of session creation.
      allOf:
        - $ref: '#/components/schemas/BaseSessionInfo'
        - type: object
          properties:
            sessionId:
              $ref: '#/components/schemas/SessionId'
            duration:
              description: |
                Session duration in seconds. Implementations can grant the requested session duration or set a different duration, based on network policies or conditions.
                - When `qosStatus` is "REQUESTED", the value is the duration to be scheduled, granted by the implementation.
                - When `qosStatus` is AVAILABLE", the value is the overall duration since `startedAt. When the session is extended, the value is the new overall duration of the session.
                - When `qosStatus` is "UNAVAILABLE", the value is the overall effective duration since `startedAt` until the session was terminated.
              type: integer
              format: int32
              minimum: 1
              example: 3600
            startedAt:
              description: Date and time when the QoS status became "AVAILABLE". Not to be returned when `qosStatus` is "REQUESTED". Format must follow RFC 3339 and must indicate time zone (UTC or local).
              type: string
              format: date-time
              example: '2024-06-01T12:00:00Z'
            expiresAt:
              description: |
                Date and time of the QoS session expiration. Format must follow RFC 3339 and must indicate time zone (UTC or local).
                - When `qosStatus` is "AVAILABLE", it is the limit time when the session is scheduled to finnish, if not terminated by other means.
                - When `qosStatus` is "UNAVAILABLE", it is the time when the session was terminated.
                - Not to be returned when `qosStatus` is "REQUESTED".
                When the session is extended, the value is the new expiration time of the session.
              type: string
              format: date-time
              example: '2024-06-01T13:00:00Z'
            qosStatus:
              $ref: '#/components/schemas/QosStatus'
            statusInfo:
              $ref: '#/components/schemas/StatusInfo'
          required:
            - sessionId
            - duration
            - qosStatus
    ExtendSessionDuration:
      description: Attributes required to extend the duration of an active session
      type: object
      properties:
        requestedAdditionalDuration:
          description: |
            Additional duration in seconds to be added to the current session duration. The overall session duration, including extensions, shall not exceed the maximum duration limit for the QoS Profile.
          type: integer
          format: int32
          minimum: 1
          example: 1800
      required:
        - requestedAdditionalDuration
    RetrieveSessionsInput:
      description: Parameters to get QoS session information by device
      type: object
      properties:
        device:
          $ref: '#/components/schemas/Device'
    RetrieveSessionsOutput:
      description: QoS session information for a given device
      type: array
      items:
        $ref: '#/components/schemas/SessionInfo'
      minItems: 0
    ConnectedNetworkType:
      type: string
      description: Network Type is intended to provide insight to connected network's capabilities from standards perspective. Actual network capabilities may differ based on implementation and MUST be checked with the connected network provider.
      enum:
        - 2G
        - 3G
        - 4G
        - 5G
        - UNKNOWN
    org.camaraproject.connected-network-type-subscriptions.v1.network-type-changed.data:
      description: Event detail structure for network type changed data events
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
            connectedNetworkType:
              $ref: '#/components/schemas/ConnectedNetworkType'
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - connectedNetworkType
            - subscriptionId
          additionalProperties: false
    TerminationReason:
      type: string
      description: |
        - NETWORK_TERMINATED - API server stopped sending notification
        - SUBSCRIPTION_UNPROCESSABLE - Subscription cannot be processed due to some reason, e.g. because the specified area cannot be managed. Useful for asynchronous subscription creation.
        - SUBSCRIPTION_EXPIRED - Subscription expire time (optionally set by the requester) has been reached
        - SUBSCRIPTION_DELETED - Subscription was deleted by the requester
        - MAX_EVENTS_REACHED - Maximum number of events (optionally set by the requester) has been reached
        - ACCESS_TOKEN_EXPIRED - Access Token sinkCredential (optionally set by the requester) expiration time has been reached
      enum:
        - MAX_EVENTS_REACHED
        - NETWORK_TERMINATED
        - SUBSCRIPTION_UNPROCESSABLE
        - SUBSCRIPTION_EXPIRED
        - SUBSCRIPTION_DELETED
        - ACCESS_TOKEN_EXPIRED
    org.camaraproject.connected-network-type-subscriptions.v1.subscription-ends.data:
      description: Event detail structure for SUBSCRIPTION_ENDS event
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
            terminationReason:
              $ref: '#/components/schemas/TerminationReason'
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
            terminationDescription:
              type: string
              description: termination description
          required:
            - terminationReason
            - subscriptionId
          additionalProperties: false
    DeviceResponse:
      description: |
        An identifier for the end-user equipment able to connect to the network that the response refers to. This parameter is only returned when the API consumer includes the `device` parameter in their request (i.e. they are using a two-legged access token), and is relevant when more than one device identifier is specified, as only one of those device identifiers is allowed in the response.

        If the API consumer provides more than one device identifier in their request, and this schema is included in the response definition, the API provider MUST use it to return a single identifier which is the one they are using to fulfil the request, even if the identifiers do not match the same device. API provider does not perform any logic to validate/correlate that the indicated device identifiers match the same device. No error should be returned if the identifiers are otherwise valid to prevent API consumers correlating different identifiers with a given end user.
      allOf:
        - $ref: '#/components/schemas/Device'
        - maxProperties: 1
    org.camaraproject.geofencing-subscriptions.v1.area-left.data:
      description: |
        Event detail structure for org.camaraproject.geofencing-subscriptions.v1.area-left event.
        Note that the device object is defined as optional and will only to be returned if provided in createSubscription.
        If more than one type of device identifier was provided, only one identifier will be returned
        (at implementation choice and with the original value provided in createSubscription).
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/DeviceResponse'
            area:
              $ref: '#/components/schemas/Area'
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - area
            - subscriptionId
          additionalProperties: false
    org.camaraproject.geofencing-subscriptions.v1.area-entered.data:
      description: |
        Event detail structure for org.camaraproject.geofencing-subscriptions.v1.area-entered event.
        Note that the device object is defined as optional and will only to be returned if provided in createSubscription.
        If more than one type of device identifier was provided, only one identifier will be returned
        (at implementation choice and with the original value provided in createSubscription).
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/DeviceResponse'
            area:
              $ref: '#/components/schemas/Area'
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - area
            - subscriptionId
          additionalProperties: false
    InitiationReason:
      type: string
      description: |
        - SUBSCRIPTION_CREATED - Subscription created by API Server
      enum:
        - SUBSCRIPTION_CREATED
    org.camaraproject.geofencing-subscriptions.v1.subscription-started.data:
      description: |
        Event detail structure for org.camaraproject.geofencing-subscriptions.v1.subscription-started event.
        Note that the device object is defined as optional and will only to be returned if provided in createSubscription.
        If more than one type of device identifier was provided, only one identifier will be returned
        (at implementation choice and with the original value provided in createSubscription).
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
            area:
              $ref: '#/components/schemas/Area'
            initiationReason:
              $ref: '#/components/schemas/InitiationReason'
            initiationDescription:
              description: Description about the start of the subscription.
              type: string
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - area
            - initiationReason
            - subscriptionId
          additionalProperties: false
    UpdateReason:
      type: string
      description: |
        - SUBSCRIPTION_ACTIVE - API server transitioned susbcription status to `ACTIVE`
        - SUBSCRIPTION_INACTIVE - API server transitioned susbcription status to `INACTIVE`
      enum:
        - SUBSCRIPTION_ACTIVE
        - SUBSCRIPTION_INACTIVE
    org.camaraproject.geofencing-subscriptions.v1.subscription-updated.data:
      description: |
        Event detail structure for org.camaraproject.geofencing-subscriptions.v1.subscription-updated event.
        Note that the device object is defined as optional and will only to be returned if provided in createSubscription.
        If more than one type of device identifier was provided, only one identifier will be returned
        (at implementation choice and with the original value provided in createSubscription).
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/Device'
            area:
              $ref: '#/components/schemas/Area'
            updateReason:
              $ref: '#/components/schemas/UpdateReason'
            updateDescription:
              description: Description about the subscription update.
              type: string
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - area
            - updateReason
            - subscriptionId
          additionalProperties: false
    org.camaraproject.geofencing-subscriptions.v1.subscription-ended.data:
      description: |
        Event detail structure for org.camaraproject.geofencing-subscriptions.v1.subscription-ended event.
        Note that the device object is defined as optional and will only to be returned if provided in createSubscription.
        If more than one type of device identifier was provided, only one identifier will be returned
        (at implementation choice and with the original value provided in createSubscription).
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            device:
              $ref: '#/components/schemas/DeviceResponse'
            area:
              $ref: '#/components/schemas/Area'
            terminationReason:
              $ref: '#/components/schemas/TerminationReason'
            terminationDescription:
              description: Explanation why a subscription ended or had to end.
              type: string
            subscriptionId:
              $ref: '#/components/schemas/SubscriptionId'
          required:
            - area
            - terminationReason
            - subscriptionId
          additionalProperties: false
    EventQosStatus:
      description: |
        The current status of a requested or previously available session. Applicable values in the event are:
        *  `AVAILABLE` - The requested QoS has been provided by the network.
        *  `UNAVAILABLE` - A requested or previously available QoS session is now unavailable. `statusInfo` may provide additional information about the reason for the unavailability.
      type: string
      enum:
        - AVAILABLE
        - UNAVAILABLE
    org.camaraproject.quality-on-demand.v1.qos-status-changed.data:
      description: Event to notify a QoS status change
      allOf:
        - $ref: '#/components/schemas/CamaraCloudEventData'
        - type: object
          properties:
            sessionId:
              $ref: '#/components/schemas/SessionId'
            qosStatus:
              $ref: '#/components/schemas/EventQosStatus'
            statusInfo:
              $ref: '#/components/schemas/StatusInfo'
          required:
            - sessionId
            - qosStatus
          additionalProperties: false
  parameters:
    x-correlator:
      name: x-correlator
      in: header
      description: Correlation id for the different services
      schema:
        $ref: '#/components/schemas/XCorrelator'
    SubscriptionId:
      name: id
      in: path
      description: Subscription identifier that was obtained from the create event subscription operation.
      required: true
      schema:
        $ref: '#/components/schemas/SubscriptionId'
    If-None-Match:
      name: If-None-Match
      in: header
      description: ETag for conditional requests
      schema:
        type: string
    If-Modified-Since:
      name: If-Modified-Since
      in: header
      description: Timestamp for conditional requests
      schema:
        type: string
        format: date-time
    If-Match:
      name: If-Match
      in: header
      description: Apply only if the ETag matches (RFC 7232).
      schema:
        type: string
  headers:
    x-correlator:
      description: Correlation id for the different services
      schema:
        $ref: '#/components/schemas/XCorrelator'
    ETag:
      description: Entity tag for caching
      schema:
        type: string
    Accept-Patch:
      description: Advertises which media types the server is able to understand in a PATCH request
      schema:
        type: string
        example: application/merge-patch+json, application/json-patch+json
    Cache-Control:
      description: Public cacheable for 10 minutes
      schema:
        type: string
        example: public, max-age=600
    Last-Modified:
      description: Timestamp of last modification
      schema:
        type: string
        format: date-time
  responses:
    Generic400:
      description: Bad Request
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic400
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 400
                  code:
                    enum:
                      - INVALID_ARGUMENT
                      - OUT_OF_RANGE
                      - '{{SPECIFIC_CODE}}'
          examples:
            GENERIC_400_INVALID_ARGUMENT:
              description: Invalid Argument. Generic Syntax Exception
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: Client specified an invalid argument, request body or query param.
            GENERIC_400_OUT_OF_RANGE:
              description: Out of Range. Specific Syntax Exception used when a given field has a pre-defined range or a invalid filter criteria combination is requested
              value:
                status: 400
                code: OUT_OF_RANGE
                message: Client specified an invalid range.
            GENERIC_400_{{SPECIFIC_CODE}}:
              description: Specific Syntax Exception regarding a field that is relevant in the context of the API
              value:
                status: 400
                code:
                  '[object Object]': null
                message:
                  '[object Object]': null
    Generic401:
      description: Unauthorized
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic401
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 401
                  code:
                    enum:
                      - UNAUTHENTICATED
          examples:
            GENERIC_401_UNAUTHENTICATED:
              description: Request cannot be authenticated and a new authentication is required
              value:
                status: 401
                code: UNAUTHENTICATED
                message: Request not authenticated due to missing, invalid, or expired credentials. A new authentication is required.
    Generic403:
      description: Forbidden
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic403
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 403
                  code:
                    enum:
                      - PERMISSION_DENIED
                      - INVALID_TOKEN_CONTEXT
                      - '{{SPECIFIC_CODE}}'
          examples:
            GENERIC_403_PERMISSION_DENIED:
              description: Permission denied. OAuth2 token access does not have the required scope or when the user fails operational security
              value:
                status: 403
                code: PERMISSION_DENIED
                message: Client does not have sufficient permissions to perform this action.
            GENERIC_403_INVALID_TOKEN_CONTEXT:
              description: Reflect some inconsistency between information in some field of the API and the related OAuth2 Token
              value:
                status: 403
                code: INVALID_TOKEN_CONTEXT
                message: '{{field}} is not consistent with access token.'
            GENERIC_403_{{SPECIFIC_CODE}}:
              description: Indicate a Business Logic condition that forbids a process not attached to a specific field in the context of the API
              value:
                status: 403
                code:
                  '[object Object]': null
                message:
                  '[object Object]': null
    CreateSubscriptionBadRequest400:
      description: Problem with the client request.
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: CreateSubscriptionBadRequest400
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 400
                  code:
                    enum:
                      - INVALID_ARGUMENT
                      - INVALID_CREDENTIAL
                      - INVALID_PROTOCOL
                      - INVALID_TOKEN
                      - DENIED_CHANGE
                      - DISALLOWED_CHANGE
          examples:
            GENERIC_400_INVALID_ARGUMENT:
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: Client specified an invalid argument, request body or query param.
            GENERIC_400_INVALID_PROTOCOL:
              value:
                status: 400
                code: INVALID_PROTOCOL
                message: Only HTTP is supported.
            GENERIC_400_INVALID_CREDENTIAL:
              value:
                status: 400
                code: INVALID_CREDENTIAL
                message: Only Access token is supported.
            GENERIC_400_INVALID_TOKEN:
              value:
                status: 400
                code: INVALID_TOKEN
                message: Only bearer token is supported.
            GENERIC_400_DENIED_CHANGE:
              value:
                status: 400
                code: DENIED_CHANGE
                message: Change request is allowed but denied at this moment.
            GENERIC_400_DISALLOWED_CHANGE:
              value:
                status: 400
                code: DISALLOWED_CHANGE
                message: Change request is always not allowed.
    SubscriptionPermissionDenied403:
      description: Client does not have sufficient permission.
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: SubscriptionPermissionDenied403
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 403
                  code:
                    enum:
                      - PERMISSION_DENIED
                      - SUBSCRIPTION_MISMATCH
          examples:
            GENERIC_403_PERMISSION_DENIED:
              value:
                status: 403
                code: PERMISSION_DENIED
                message: Client does not have sufficient permissions to perform this action.
            GENERIC_403_TOKEN_MISMATCH:
              value:
                status: 403
                code: SUBSCRIPTION_MISMATCH
                message: Inconsistent access token for requested events subscription.
    Generic409:
      description: Conflict
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic409
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 409
                  code:
                    enum:
                      - ABORTED
                      - ALREADY_EXISTS
                      - CONFLICT
                      - '{{SPECIFIC_CODE}}'
          examples:
            GENERIC_409_ABORTED:
              description: Concurreny of processes of the same nature/scope
              value:
                status: 409
                code: ABORTED
                message: Concurrency conflict.
            GENERIC_409_ALREADY_EXISTS:
              description: Trying to create an existing resource
              value:
                status: 409
                code: ALREADY_EXISTS
                message: The resource that a client tried to create already exists.
            GENERIC_409_CONFLICT:
              description: Duplication of an existing resource
              value:
                status: 409
                code: CONFLICT
                message: A specified resource duplicate entry found.
            GENERIC_409_{{SPECIFIC_CODE}}:
              description: Specific conflict situation that is relevant in the context of the API
              value:
                status: 409
                code:
                  '[object Object]': null
                message:
                  '[object Object]': null
    CreateSubscriptionUnprocessableEntity422:
      description: Unprocessable Entity
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: CreateSubscriptionUnprocessableEntity422
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 422
                  code:
                    enum:
                      - IDENTIFIER_MISMATCH
                      - MISSING_IDENTIFIER
                      - SERVICE_NOT_APPLICABLE
                      - UNNECESSARY_IDENTIFIER
                      - UNSUPPORTED_IDENTIFIER
                      - GEOFENCING_SUBSCRIPTIONS.AREA_NOT_COVERED
                      - GEOFENCING_SUBSCRIPTIONS.INVALID_AREA
                      - GROUP_SUBSCRIPTIONS.INVALID_GROUP
                      - NOTIFICATION_POLICY_NOT_SUPPORTED
                      - INVALID_NOTIFICATION_POLICY
                      - SEMANTIC_RULE_VIOLATED
          examples:
            GENERIC_422_IDENTIFIER_MISMATCH:
              description: Inconsistency between device identifiers not pointing to the same device.
              value:
                status: 422
                code: IDENTIFIER_MISMATCH
                message: Provided identifiers are not consistent.
            GENERIC_422_SERVICE_NOT_APPLICABLE:
              description: Service not applicable for the provided identifier
              value:
                status: 422
                code: SERVICE_NOT_APPLICABLE
                message: The service is not available for the provided identifier.
            GENERIC_422_MISSING_IDENTIFIER:
              description: An identifier is not included in the request and the device or phone number identification cannot be derived from the 3-legged access token
              value:
                status: 422
                code: MISSING_IDENTIFIER
                message: The device cannot be identified.
            GENERIC_422_UNNECESSARY_IDENTIFIER:
              description: An explicit identifier is provided when a device or phone number has already been identified from the access token
              value:
                status: 422
                code: UNNECESSARY_IDENTIFIER
                message: The device is already identified by the access token.
            GENERIC_422_UNSUPPORTED_IDENTIFIER:
              description: None of the provided identifiers is supported by the implementation
              value:
                status: 422
                code: UNSUPPORTED_IDENTIFIER
                message: The identifier provided is not supported.
            GEOFENCING_422_AREA_NOT_COVERED:
              summary: The area cannot be covered
              description: The system is not able cover the requested area
              value:
                status: 422
                code: GEOFENCING_SUBSCRIPTIONS.AREA_NOT_COVERED
                message: Unable to cover the requested area
            GEOFENCING_422_INVALID_AREA:
              summary: Invalid area
              description: The requested area is too small to be supported by the system.
              value:
                status: 422
                code: GEOFENCING_SUBSCRIPTIONS.INVALID_AREA
                message: The requested area is too small
            GROUP_422_INVALID_GROUP:
              summary: Invalid group identifier
              description: The requested group identifier is not valid.
              value:
                status: 422
                code: GROUP_SUBSCRIPTIONS.INVALID_GROUP
                message: The requested group identifier is not valid.
            NOTIFICATION_POLICY_NOT_SUPPORTED:
              summary: Notification policy is not supported
              description: Notification policy is not supported
              value:
                status: 422
                code: NOTIFICATION_POLICY_NOT_SUPPORTED
                message: Notificatio policy is not supportedd.
            INVALID_NOTIFICATION_POLICY:
              summary: Notification policy configuration is invalid
              description: Notification policy configuration is invalid
              value:
                status: 422
                code: INVALID_NOTIFICATION_POLICY
                message: Notification policy configuration is invalid.
            SEMANTIC_RULE_VIOLATED:
              summary: Semantic rule violated
              description: Semantic rule violated (e.g., forbidden state transition)
              value:
                status: 422
                code: SEMANTIC_RULE_VIOLATED
                message: Semantic rule violated.
    Generic429:
      description: Too Many Requests
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic429
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 429
                  code:
                    enum:
                      - QUOTA_EXCEEDED
                      - TOO_MANY_REQUESTS
          examples:
            GENERIC_429_QUOTA_EXCEEDED:
              description: Request is rejected due to exceeding a business quota limit
              value:
                status: 429
                code: QUOTA_EXCEEDED
                message: Out of resource quota.
            GENERIC_429_TOO_MANY_REQUESTS:
              description: Access to the API has been temporarily blocked due to rate or spike arrest limits being reached
              value:
                status: 429
                code: TOO_MANY_REQUESTS
                message: Rate limit reached.
    Generic410:
      description: Gone
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic410
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 410
                  code:
                    enum:
                      - GONE
          examples:
            GENERIC_410_GONE:
              description: Use in notifications flow to allow API Consumer to indicate that its callback is no longer available
              value:
                status: 410
                code: GONE
                message: Access to the target resource is no longer available.
    Generic304:
      description: Not Modified
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic304
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 304
                  code:
                    enum:
                      - NOT_MODIFIED
          examples:
            GENERIC_304_NOT_MODIFIED:
              description: Not Modified. The resource has not been modified since the last request.
              value:
                status: 304
                code: NOT_MODIFIED
                message: The resource has not been modified since the last request.
    SubscriptionIdRequired400:
      description: Problem with the client request
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: SubscriptionIdRequired400
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 400
                  code:
                    enum:
                      - INVALID_ARGUMENT
          examples:
            GENERIC_400_INVALID_ARGUMENT:
              summary: Schema validation failed
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: Client specified an invalid argument, request body or query param.
            GENERIC_400_SUBSCRIPTION_ID_REQUIRED:
              summary: The subscription id is required
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: 'Expected property is missing: subscriptionId'
    Generic404:
      description: Not found
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic404
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 404
                  code:
                    enum:
                      - NOT_FOUND
                      - IDENTIFIER_NOT_FOUND
                      - '{{SPECIFIC_CODE}}'
          examples:
            GENERIC_404_NOT_FOUND:
              description: Resource is not found
              value:
                status: 404
                code: NOT_FOUND
                message: The specified resource is not found.
            GENERIC_404_IDENTIFIER_NOT_FOUND:
              description: Some identifier cannot be matched to a device
              value:
                status: 404
                code: IDENTIFIER_NOT_FOUND
                message: Device identifier not found.
            GENERIC_404_{{SPECIFIC_CODE}}:
              description: Specific situation to highlight the resource/concept not found
              value:
                status: 404
                code:
                  '[object Object]': null
                message:
                  '[object Object]': null
    Generic412:
      description: Failed precondition
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic412
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 412
                  code:
                    enum:
                      - FAILED_PRECONDITION
          examples:
            GENERIC_412_FAILED_PRECONDITION:
              description: Indication by the API Server that the request cannot be processed in current system state
              value:
                status: 412
                code: FAILED_PRECONDITION
                message: Request cannot be executed in the current system state.
    Generic415:
      description: Unsupported Media Type
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic415
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 415
                  code:
                    enum:
                      - UNSUPPORTED_MEDIA_TYPE
          examples:
            GENERIC_415_UNSUPPORTED_MEDIA_TYPE:
              description: Payload format of the request is in an unsupported format by the Server. Should not happen
              value:
                status: 415
                code: UNSUPPORTED_MEDIA_TYPE
                message: The server refuses to accept the request because the payload format is in an unsupported format.
    CreateSessionBadRequest400:
      description: Bad Request when creating a session
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: CreateSessionBadRequest400
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 400
                  code:
                    enum:
                      - INVALID_ARGUMENT
                      - OUT_OF_RANGE
                      - QUALITY_ON_DEMAND.DURATION_OUT_OF_RANGE
                      - INVALID_CREDENTIAL
                      - INVALID_TOKEN
          examples:
            GENERIC_400_INVALID_ARGUMENT:
              description: Invalid Argument. Generic Syntax Exception
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: Client specified an invalid argument, request body or query param.
            GENERIC_400_OUT_OF_RANGE:
              description: Out of Range. Specific Syntax Exception used when a given field has a pre-defined range or a invalid filter criteria combination is requested
              value:
                status: 400
                code: OUT_OF_RANGE
                message: Client specified an invalid range.
            DurationOutOfRangeForQoSProfile:
              description: The requested duration is out of the allowed range for the specific QoS profile
              value:
                status: 400
                code: QUALITY_ON_DEMAND.DURATION_OUT_OF_RANGE
                message: The requested duration is out of the allowed range for the specific QoS profile
            GENERIC_400_INVALID_CREDENTIAL:
              value:
                status: 400
                code: INVALID_CREDENTIAL
                message: Only Access token is supported
            GENERIC_400_INVALID_TOKEN:
              value:
                status: 400
                code: INVALID_TOKEN
                message: Only bearer token is supported
    GenericDevice404:
      description: Not found
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: GenericDevice404
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 404
                  code:
                    enum:
                      - NOT_FOUND
                      - IDENTIFIER_NOT_FOUND
          examples:
            GENERIC_404_NOT_FOUND:
              description: Resource is not found
              value:
                status: 404
                code: NOT_FOUND
                message: The specified resource is not found.
            GENERIC_404_DEVICE_NOT_FOUND:
              description: Device identifier not found
              value:
                status: 404
                code: IDENTIFIER_NOT_FOUND
                message: Device identifier not found.
    SessionInConflict409:
      description: Conflict
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: SessionInConflict409
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 409
                  code:
                    enum:
                      - CONFLICT
          example:
            status: 409
            code: CONFLICT
            message: Conflict with an existing session for the same device.
    Generic422:
      description: Unprocessable Content
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: Generic422
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 422
                  code:
                    enum:
                      - SERVICE_NOT_APPLICABLE
                      - MISSING_IDENTIFIER
                      - UNSUPPORTED_IDENTIFIER
                      - UNNECESSARY_IDENTIFIER
                      - '{{SPECIFIC_CODE}}'
          examples:
            GENERIC_422_SERVICE_NOT_APPLICABLE:
              description: Service not applicable for the provided identifier
              value:
                status: 422
                code: SERVICE_NOT_APPLICABLE
                message: The service is not available for the provided identifier.
            GENERIC_422_MISSING_IDENTIFIER:
              description: An identifier is not included in the request and the device or phone number identification cannot be derived from the 3-legged access token
              value:
                status: 422
                code: MISSING_IDENTIFIER
                message: The device cannot be identified.
            GENERIC_422_UNSUPPORTED_IDENTIFIER:
              description: None of the provided identifiers is supported by the implementation
              value:
                status: 422
                code: UNSUPPORTED_IDENTIFIER
                message: The identifier provided is not supported.
            GENERIC_422_UNNECESSARY_IDENTIFIER:
              description: An explicit identifier is provided when a device or phone number has already been identified from the access token
              value:
                status: 422
                code: UNNECESSARY_IDENTIFIER
                message: The device is already identified by the access token.
            GENERIC_422_{{SPECIFIC_CODE}}:
              description: Any semantic condition associated to business logic, specifically related to a field or data structure
              value:
                status: 422
                code:
                  '[object Object]': null
                message:
                  '[object Object]': null
    GenericExtendSessionDuration400:
      description: Bad Request
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: GenericExtendSessionDuration400
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 400
                  code:
                    enum:
                      - INVALID_ARGUMENT
                      - OUT_OF_RANGE
                      - QUALITY_ON_DEMAND.DURATION_OUT_OF_RANGE
          examples:
            GENERIC_400_INVALID_ARGUMENT:
              description: Invalid Argument. Generic Syntax Exception
              value:
                status: 400
                code: INVALID_ARGUMENT
                message: Client specified an invalid argument, request body or query param.
            GENERIC_400_OUT_OF_RANGE:
              description: Out of Range. Specific Syntax Exception used when a given field has a pre-defined range or a invalid filter criteria combination is requested
              value:
                status: 400
                code: OUT_OF_RANGE
                message: Client specified an invalid range.
            DurationOutOfRangeForQoSProfile:
              description: NOTE - this error response cannot be returned by the `/extend` operation and will be removed from the API definition in the next version.
              value:
                status: 400
                code: QUALITY_ON_DEMAND.DURATION_OUT_OF_RANGE
                message: The requested duration is out of the allowed range for the specific QoS profile
    SessionStatusConflict409:
      description: Conflict
      headers:
        x-correlator:
          $ref: '#/components/headers/x-correlator'
      content:
        application/json:
          schema:
            title: SessionStatusConflict409
            allOf:
              - $ref: '#/components/schemas/ErrorInfo'
              - type: object
                properties:
                  status:
                    enum:
                      - 409
                  code:
                    enum:
                      - QUALITY_ON_DEMAND.SESSION_EXTENSION_NOT_ALLOWED
          examples:
            SessionExtensionNotAllowed:
              description: Session extension is in conflict with current session status
              value:
                status: 409
                code: QUALITY_ON_DEMAND.SESSION_EXTENSION_NOT_ALLOWED
                message: Extending the session duration is not allowed in the current state ({qosStatus}). The session must be in the AVAILABLE state.
  examples:
    EVENT_QOS_STATUS_CHANGED_EXAMPLE:
      summary: QoS status changed
      description: Cloud event example for QoS status change to UNAVAILABLE due to DURATION_EXPIRED
      value:
        id: 83a0d986-0866-4f38-b8c0-fc65bfcda452
        source: https://api.example.com/qod/v1/sessions/123e4567-e89b-12d3-a456-426614174000
        specversion: '1.0'
        type: org.camaraproject.quality-on-demand.v1.qos-status-changed
        time: '2024-06-01T13:00:00Z'
        data:
          sessionId: 123e4567-e89b-12d3-a456-426614174000
          qosStatus: UNAVAILABLE
          statusInfo: DURATION_EXPIRED
    SESSION_AVAILABLE_EXAMPLE:
      summary: QoS session status is available
      description: QoS session info when status is available
      value:
        duration: 3600
        device:
          ipv4Address:
            publicAddress: 203.0.113.0
            publicPort: 59765
        applicationServer:
          ipv4Address: 198.51.100.0/24
        qosProfile: QOS_L
        subscriptionRequest:
          sink: https://application-server.com/notifications
        sessionId: 3fa85f64-5717-4562-b3fc-2c963f66afa6
        startedAt: '2024-06-01T12:00:00Z'
        expiresAt: '2024-06-01T13:00:00Z'
        qosStatus: AVAILABLE
    SESSION_UNAVAILABLE_EXAMPLE:
      summary: QoS session is unavailable
      description: QoS session info when status is unavailable due to network termination
      value:
        duration: 2428
        device:
          ipv4Address:
            publicAddress: 203.0.113.0
            publicPort: 59765
        applicationServer:
          ipv4Address: 198.51.100.0/24
        qosProfile: QOS_L
        subscriptionRequest:
          sink: https://application-server.com/notifications
        sessionId: 3fa85f64-5717-4562-b3fc-2c963f66afa6
        startedAt: '2024-06-01T12:00:00Z'
        expiresAt: '2024-06-01T12:40:28Z'
        qosStatus: UNAVAILABLE
        statusInfo: NETWORK_TERMINATED
    RETRIEVE_SESSIONS_EXAMPLE:
      summary: List of QoS sessions for the device
      description: A single QoS session for the device is available
      value:
        - duration: 3600
          device:
            phoneNumber: '+123456789'
          applicationServer:
            ipv4Address: 0.0.0.0/0
          qosProfile: QOS_L
          subscriptionRequest:
            sink: https://application-server.com/notifications
          sessionId: 3fa85f64-5717-4562-b3fc-2c963f66afa6
          startedAt: '2024-06-01T12:00:00Z'
          expiresAt: '2024-06-01T13:00:00Z'
          qosStatus: AVAILABLE
    RETRIEVE_SESSIONS_EMPTY_EXAMPLE:
      summary: No sessions found for the device
      description: An empty array is returned when no sessions are found for the device
      value: []
